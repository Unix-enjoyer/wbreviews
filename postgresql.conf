# postgresql.conf - оптимизация для загрузки больших объемов
max_wal_senders = 0
listen_addresses = '*'
# Memory Settings
shared_buffers = 512MB           # 25% от доступной памяти
work_mem = 32MB                  # Память на операцию сортировки
maintenance_work_mem = 1GB       # Память на обслуживание
effective_cache_size = 2GB       # Ожидаемый размер кэша

# Checkpoint Settings (увеличиваем для bulk load)
checkpoint_timeout = 30min       # Увеличиваем интервал чекпоинтов
checkpoint_completion_target = 0.9
max_wal_size = 2GB
min_wal_size = 1GB

# WAL Settings
wal_level = minimal              # Минимальный уровень для загрузки
synchronous_commit = off         # Отключаем для скорости
full_page_writes = off           # Отключаем для bulk load

# Connection Settings
max_connections = 100
superuser_reserved_connections = 3

# Performance Settings
max_parallel_workers_per_gather = 0  # Отключаем параллельные запросы
wal_compression = on
wal_buffers = 16MB

# Autovacuum Settings
autovacuum = on
autovacuum_max_workers = 3
autovacuum_naptime = 1min
autovacuum_vacuum_threshold = 50
autovacuum_analyze_threshold = 50
autovacuum_vacuum_scale_factor = 0.2
autovacuum_analyze_scale_factor = 0.1